<?xml version="1.0" encoding="UTF-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/><!--Faltan os outros np (antropónimos) que teñen gen e nbr, revisar regras.-->
      <cat-item tags="np.loc.*"/>
    </def-cat>

     <def-cat n="ant">
      <cat-item tags="np.ant.*"/>
    </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    <def-cat n="adj_pp">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="det"><!--Determinantes e predeterminantes, van antepostos en galego -->
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
      <!-- <cat-item tags="num.*"/> -->
    </def-cat>

    <def-cat n="o"><!--afegir-hi tb 'un'? (un 30%). No sé si tb desapareix -->
      <cat-item lemma="o" tags="det.def.m.sg"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="percent">
      <cat-item tags="num.percent"/>
    </def-cat>

    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="a">
      <cat-item tags="pr"/>
    </def-cat>

    <def-cat n="prpers">
      <cat-item lemma="prpers" tags="prn.*"/>
    </def-cat>

    <def-cat n="tn_itg_pos"><!--Aquí no hi entren els pronoms personals, caldrà fer-ne un xunc a part. -->
      <cat-item tags="prn.tn.m.*"/>
      <cat-item tags="prn.tn.f.*"/>
      <cat-item tags="prn.tn.mf.*"/>
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pos.*"/>
    </def-cat>
    
    <def-cat n="enc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="pro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>

    <def-cat n="verbnm_inf_ger"><!--verb no modal, infinitiu i gerundi -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbser.pron.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.pron.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbser.pron.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbhaver.pron.ger"/>
    </def-cat>

    <def-cat n="verbnm_imp"><!--verb no modal, imperatiu -->
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pron.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pron.imp.*"/>
    </def-cat>

    <def-cat n="verbm"><!--verb modal -->
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="verbm_inf_ger"><!--verb modal, infinitiu o gerundi -->
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>

    <def-cat n="haver">
      <cat-item tags="vbhaver.*"/>
    </def-cat>

 <def-cat n="há">
      <cat-item tags="vbhaver.*.p3.sg"/>
      <cat-item lemma="há" tags="vblex.*"/>
    </def-cat>

 <def-cat n="há_lex">
      <cat-item lemma="há" tags="vblex.*"/>
    </def-cat>

  <def-cat n="estar">
      <cat-item lemma="estar" tags="vblex.cni.*"/>
      <cat-item lemma="estar" tags="vblex.fti.*"/>
      <cat-item lemma="estar" tags="vblex.ifi.*"/>
      <cat-item lemma="estar" tags="vblex.imp.*"/>
      <cat-item lemma="estar" tags="vblex.pii.*"/>
      <cat-item lemma="estar" tags="vblex.pmp.*"/>
      <cat-item lemma="estar" tags="vblex.pis.*"/>
      <cat-item lemma="estar" tags="vblex.fts.*"/>
      <cat-item lemma="estar" tags="vblex.pri.*"/>
      <cat-item lemma="estar" tags="vblex.prs.*"/>
  </def-cat>

    <def-cat n="verbcj">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pmp.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.fts.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pmp.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.fts.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pmp.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.fts.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.ifi.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pmp.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbmod.fts.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pmp.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.fts.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.pron.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/><!--ATENCIÓ: CANVI -->
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>


    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="mais">
      <cat-item lemma="mais" tags="adv"/>
      <cat-item lemma="mais" tags="preadv"/>
      <cat-item lemma="mais" tags="det.*"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>

    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>

    <def-cat n="non">
      <cat-item lemma="non" tags="adv"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item lemma="e" tags="cnjcoo"/>
      <cat-item lemma="ou" tags="cnjcoo"/>
      <cat-item lemma="mais" tags="cnjcoo"/>
      <cat-item lemma="pero" tags="cnjcoo"/>
    </def-cat>

     <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>


    <def-cat n="para">
      <cat-item lemma="para" tags="pr"/>
    </def-cat>

    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>

    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="o_que">
      <cat-item lemma="o que" tags="rel.nn.*"/>
    </def-cat>
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

  <def-cat n="coma">
      <cat-item tags="cm"/>
    </def-cat>

  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.al"/>	
      <attr-item tags="np.cog"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/>
      <attr-item tags="adj.sint"/>
      <attr-item tags="adj.sint.comp"/>
      <attr-item tags="adj.sint.sup"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="vblex.pp"/>
    </def-attr>  


    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>

    <def-attr n="sep">
      <attr-item tags="sep"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>

    <def-attr n="a_rel">
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.an"/>
      <attr-item tags="rel.adv"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="obj"/>
      <attr-item tags="tn"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>  
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pmp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>
      <attr-item tags="pp"/>
      <attr-item tags="pprs"/>
      <attr-item tags="subs"/>
      <attr-item tags="ger"/>
      <attr-item tags="inf"/>
    </def-attr>



    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>  

  </section-def-attrs>
  <section-def-vars>
    <def-var n="nombre" v="&amp;lt;sg&amp;gt;"/>
    <def-var n="genere" v="&amp;lt;m&amp;gt;"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="caseFirstWord"/> 
    <def-var n="caseSecondWord"/>
    <def-var n="lema"/>
    <def-var n="lema_SV"/>
    <def-var n="EOS" v="true"/>
    <def-var n="paraula1"/>
    <def-var n="SVnegatiu"/>
    <def-var n="auxiliar"/>
    <def-var n="adv_adjectiu"/>
    <def-var n="tempsv"/>
    <def-var n="temps_chunk"/>
    <def-var n="pers_chunk"/>
    <def-var n="nbr_chunk"/>
    <def-var n="gen_chunk"/>
    <def-var n="verbfinal"/>
  </section-def-vars>

  <section-def-lists>

    <def-list n="det_canviant">
      <list-item v="un"/>
      <list-item v="outro"/>
      <list-item v="pouco"/>
      <list-item v="canto"/>
      <list-item v="menos"/>
      <list-item v="moito"/>
      <list-item v="tanto"/>
      <list-item v="demasiado"/>
    </def-list>



 <def-list n="preps_inf">
      <list-item v="so as to"/>
      <list-item v="with a view to"/>
      <list-item v="to"/>
      <list-item v="in order to"/>
    </def-list>

 <def-list n="en_majuscules">
      <list-item v="Monday"/>
      <list-item v="Tuesday"/>
      <list-item v="Wednesday"/>
      <list-item v="Thursday"/>
      <list-item v="Friday"/>
      <list-item v="Saturday"/>
      <list-item v="Sunday"/>
 </def-list>



  </section-def-lists>


  <section-def-macros>
    

    <def-macro n="f_bcond" npar="1"><!--Para mirar se o branco contén ou non formato. É necesario pór esta función nas regras en que desapareza algunha palabra, para decidir se o branco da palabra eliminada se debe eliminar ou conservar. Se contén formato debe conservarse, se non o contén debe eliminarse para que non aparezan dous espazos seguidos. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>


    <def-macro n="nombre_nom" npar="1"><!-- per determinar si hi ha hagut canvi de nombre en la traducció. Després d'aquesta macro s'aplica la macro 'canvia_det'. Caldria ajuntar aquesta macro i la 'canvia_det' !!!!!!! -->
      <let>
	<var n="nombre"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="pl_slsg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="sg_slpl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="nombre"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</otherwise>
      </choose> 
    </def-macro>

   




    <def-macro n="canvia_det" npar="2">
      <choose>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="det_canviant"/>
	    </in>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="sg_slpl"/>
		  </equal>
		  <and><!--perquè no doni error en casos (errors original) com 'uns arbre' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="some"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="a"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.ind"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="other"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="another"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="few"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="little"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="fewer"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="pl_slsg"/>
		  </equal>
		  <and><!--perquè no doni error en casos com 'un Cases' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="a"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="some"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.qnt"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="another"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="other"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="little"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="few"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="less"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="menos"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="demasiado"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	  </choose>
	</when>

      </choose>
    </def-macro>

 <def-macro n="f_concord2" npar="2"><!--element 1= principal (nom). Element 2 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>	

	  </choose>
	</when>
      </choose>
</def-macro>
		
	


<def-macro n="f_concord3" npar="3"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>


<def-macro n="f_concord4" npar="4"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="4" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="4" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>
		  



<def-macro n="elimina_ND" npar="1">
  <choose>
    <when>
      <test>
	<equal>
	  <clip pos="1" side="tl" part="nbr"/>
	  <lit-tag v="ND"/>
	</equal>
      </test>
      <let>
	<clip pos="1" side="tl" part="nbr"/>
	<lit-tag v="sg"/>
      </let>
    </when>
  </choose>
</def-macro>
	
	  


  <def-macro n="firstWord" npar="1"><!--nova versió 8-febr-08, comprovar si va bé. Si va bé, posar-la també en en-ca -->
      
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <choose>
		<when>
		  <test>
		    <and>
		      <equal>
			<clip pos="1" side="sl" part="a_np_acr"/>
			<lit v=""/>
		      </equal>
		      <not>
			<in>
			  <clip pos="1" side="tl" part="lem"/>
			  <list n="en_majuscules"/>
			</in>
		      </not>
		    </and>
		  </test>
		  <modify-case>
		    <clip pos="1" side="tl" part="lem"/>
		    <lit v="aa"/>
		  </modify-case>
		</when>
	      </choose>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	    <otherwise> 
	      <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	      </let>
	    </otherwise>
	  </choose>
<!--	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>-->
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>


<!--
  <def-macro n="firstWord" npar="1">
      <choose>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="a_np_acr"/>
		<lit v=""/>
	      </equal>
	      <not>
		<in>
		  <clip pos="1" side="tl" part="lem"/>
		  <list n="en_majuscules"/>
		</in>
	      </not>
	    </and>
	  </test>
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <modify-case>
		<clip pos="1" side="tl" part="lem"/>
		<lit v="aa"/>
	      </modify-case>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	    <otherwise> 
	      <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	      </let>
	    </otherwise>
	  </choose>
	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>


-->

<def-macro n="prep_inf" npar="2">
      <choose>
	<when>
	  <test>
	    <or>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="para"/>
	      </equal>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="de"/>
	      </equal>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="por"/>
	      </equal>	      
	    </or>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	    <lit v="to"/>
	  </let>
	</when>


      </choose>
      <choose>
	<when>
	  <test>
	    <not>
	      <in caseless="yes">
		<clip pos="1" side="tl" part="lem"/>
		<list n="preps_inf"/>
	      </in>
	    </not>
	  </test>
	  <let>	    
	    <clip pos="2" side="tl" part="temps"/>
	    <lit-tag v="ger"/>
	  </let>
	  <let>
	    <var n="tempsv"/>
	    <lit v="ger"/>
	  </let>
	  <choose>	    
	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="poder"/>
		</equal>
	      </test>
	      <let>		     
		<clip pos="2" side="tl" part="lem"/>
		<get-case-from pos="2">
		  <lit v="be able to"/>
		</get-case-from>
	      </let>
	      <let>		     
		<clip pos="2" side="tl" part="a_verb"/>
		<lit-tag v="vbmod"/>
	      </let>
	    </when>
	  </choose>
	</when>
	<otherwise>
	  <let>
	    <var n="tempsv"/>
	    <lit v="inf"/>
	  </let>
	</otherwise>
      </choose>
</def-macro>


<def-macro n="adv_adj" npar="2"><!-- (per a fer el comparatiu si cal: 'més fosc' = darker; i també per a canviar 'well' per 'very' davant adjectius )" -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="mais"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="bem mais"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="much"/>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="bem"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <lit v="very"/>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </otherwise>
	</choose>

	      
		
		
</def-macro>

<def-macro n="det_adv_adj" npar="3"><!-- (para facer a comparativa e superlativa se é necesario: 'máis escuro' = 'darker'; 'o máis escuro' = 'the darkest')" -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="mais"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="a_det"/>
		    <lit-tag v="det.def"/>
		  </equal>
		</test>		  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lem"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="sup"/>
		  </concat>
		</let>
	      </when>
	      <otherwise>	  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lem"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="comp"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </when>

	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="bem mais"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="lem"/> 
	      <lit v="much"/>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="mais"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="a_det"/>
		  <lit-tag v="det.def"/>
		</equal>
	      </and>
	    </test>	
	    <let>  
	      <clip pos="2" side="tl" part="lem"/> 
	      <lit v="most"/>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="bem"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <lit v="very"/>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</concat>
	    </let>
	  </otherwise>
	</choose>
</def-macro>


<def-macro n="el_millor_pitjor" npar="2"><!-- para crear a forma superlativa cando o lema é superlativo e o artigo é definico ou posesivo -->
       <choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.def"/>		
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.pos"/>		
		  </equal>
		</or>
		<or>
		  <equal>
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="melhor"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="pior"/>
		  </equal>
		</or>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <lit-tag v="adj.sint.sup"/>
	    </let>
	  </when>
	</choose> 
</def-macro>
		


 <def-macro n="conj_verb1" npar="1"><!--conjuga un verb -->

	<choose>
	  <when>
	    <test><!--Se é verbo 'ser' p1 ou p3 en presente ou pasade (ou subxuntivo) ten unha conxugación propia en inglés. Inclúe 'ser' e 'estar', ambos os dous son 'vbser' en inglés (to be) -->
	      <and>
		<equal>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="vbser"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pmp"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fts"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <lit-tag v="vbser"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/>
	      </concat>
	    </let>
	  </when>


	  <when> 
	    <test><!--O resto dos verbos teñen tamén prs e nbr para p3 sg, agás os auxiliares (can). -->
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
		<not>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</not>
	      </and>
	    </test>

	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers"/>
		<clip pos="1" side="tl" part="nbr"/> 
	      </concat>
	    </let>

	  </when>
	  <otherwise><!--o resto das formas verbais non teñen pers e nbr en inglés -->
	    <choose>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <not>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		      <lit v="would"/>
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>


	      </when>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/> 
		      <lit v="poder"/>
		    </equal>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>

	      <when>
		<test>		 
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </test>
		    <let>
		      <clip pos="1" side="tl" part="lem"/>
		      <get-case-from pos="1">
			<lit v="be able to"/>
		      </get-case-from>
		    </let>
		    <let>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vbmod"/>
		    </let>
		  </when>
		</choose>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		      <lit v="will"/>
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>

	      </when>

	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/> 
		      <lit-tag v="pri"/><!--digo -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="prs"/><!--diga -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>

		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="ifi"/><!--dixo -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pii"/><!--dicía -->
		    </equal>
		    <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pmp"/><!--dixera -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pis"/><!--dixese -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="fts"/><!--dixer -->
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	       <otherwise><!--as formas non persoais (inf e ger) -->

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
</def-macro>


 <def-macro n="conj_haverhi_pp" npar="1"><!--conxuga o verbo haver-hi cando vai seguido de pp -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/> 
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pmp"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="fts"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <lit v="would"/>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <lit v="will"/>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>


 <def-macro n="conj_haverhi" npar="1"><!--conjuga el verb haver-hi -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pmp"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="fts"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <lit v="would"/>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <lit v="will"/>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>




  </section-def-macros> 

  <section-rules>




    <!--*************************************** REGRAS DE SN ******************************************** -->

    <rule comment="REGRA: NOME (para colocar a cola nas multipalabras con g)">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag><!--mantense con finalidades informativas -->
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

<rule comment="REGRA: ANTROPÓNIMO">
      <pattern>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGRA: DET ANTROPÓNIMO (A María - María)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="REGRA: DET NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="det_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	 
      </action>
    </rule>


    <rule comment="REGRA: NUM NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="REGRA: NOM ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>

    <rule comment="REGRA: NOM ADJ ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	
	<out> 
	  <chunk name="nom_adj_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>
    


    <rule comment="REGRA: DET NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<out>  
	  <chunk name="det_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>



    <rule comment="REGRA: DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="3" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


 <rule comment="REGRA: DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_adj_adj_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>



    <rule comment="REGRA: NUM NOM ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


    <rule comment="REGRA: DET NOM ADV ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="det_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out> 
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro>    
      </action>
    </rule>

    <rule comment="REGRA: NUM NOM ADV ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="adv_adj">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>   
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	</call-macro> 
      </action>
    </rule>



    <rule comment="REGRA: NOM ADJ conj ADJ NOM (aspecto fráxil e tímida aparencia -> fragile look and shy appearance. Regra creada para que non entren frases que non toquen na regra seguinte">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>	
	    <call-macro n="f_concord2">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="5"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="5"/>
	    </call-macro>

	    <out>
	      <chunk name="nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>	
	    <call-macro n="f_concord3">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	      
	      <b pos="4"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr" link-to="3"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose> 
      </action>
    </rule>

    <rule comment="REGRA: NOM ADJ conj ADJ (aspecto fráxil e tímido -> fragile and shy look">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <clip pos="4" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <clip pos="4" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test> -->
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	<!--  </when>
	  <otherwise>
	    <out>
	      <chunk name="nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="2"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="4" side="sl" part="gen"/></tag>
		  <tag><clip pos="4" side="sl" part="nbr"/></tag>
		</tags>		 
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu>
	      </chunk>
	    </out>	 
	  </otherwise>
	</choose>      --> 
      </action>
    </rule>


    <rule comment="REGRA: DET NOM ADJ conj ADJ NOM (un aspecto fráxil e tímida aparencia -> a fragile look and shy appearance. Regra creada para que non entren frases que non toquen na regra seguinte)"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="5" side="sl" part="gen"/>
		  <clip pos="6" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="nbr"/>
		  <clip pos="6" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>
	    <call-macro n="f_concord3">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="6"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="6"/>
	    </call-macro>
	    <out>
	      <chunk name="det_nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>

		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="5"/>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <call-macro n="f_concord4">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	      <b pos="5"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="6" side="sl" part="gen"/></tag>
		  <tag><clip pos="6" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr" link-to="3"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     
      </action>
    </rule>

    <rule comment="REGRA: DET NOM ADJ conj ADJ (un aspecto fráxil e tímido -> a fragile and shy look">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="5"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>		
	    </test> -->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
<!--	  </when>
	  <otherwise>	      
	    <out>
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="3"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     --> 
      </action>
    </rule>

    <rule comment="REGRA: ADXECTIVO (cando non acompaña nada ou vai con descoñecida)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule> 


    <rule comment="REGRA: ADV ADXECTIVO (para facer comparativas e superlativas: 'máis longo - longer')">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	    <out>
	      <chunk name="adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
      </action>
    </rule> 


 <rule comment="REGRA: DET ADV ADXECTIVO (o feo / o mellor) ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="2" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>		
	<out>
	  <chunk name="det_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	</call-macro>
      </action>
    </rule> 




   <rule comment="REGRA: DET ADV ADJECTIVO (para fazer comparativas e superlativas: 'a mais grande - the biggest; a mais importante - the most important')">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="mais"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when><!--trampa para arranxar cando o 'máis' non é adv senón determinante -->
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="a_adv"/> 
		<lit v=""/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="whole"/> 
	      <concat>
		<clip pos="2" side="tl" part="lem"/> 
		<lit-tag v="adv"/>
	      </concat>
	    </let>
	  </when>
	</choose>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	 

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="3" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
	      
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="mais"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test> -->
	    <out>
	      <chunk name="det_adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	    </call-macro>
      </action>
    </rule> 

    <rule comment="REGRA: NUMERAL.">
      <pattern>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="NUM"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_num"/> 
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="REGRA: DETERMINANTE (para que non dea erro se vai diante de descoñecidas e non se pode atribuír número. falta a regra t2x para os ND)">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>        	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


<!-- Check this: I think it can be dropped -->
<rule comment="REGRA: o (num)%">
      <pattern>
	<pattern-item n="o"/>
	<pattern-item n="percent"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="percent">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
      </action>
</rule>


    <!-- *************************************** REGRAS DE SV *********************************************** -->

 <rule comment="REGRA: HABER">
      <pattern>
	<pattern-item n="há"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="1"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	    </out>
      </action>
    </rule>

  

    <rule comment="REGRA: VERB conxugado">
      <pattern>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

  


    <rule comment="HAVER + PP (han vist - have seen)">
<!--comprobar a necesidade desta regra en galego-->
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="1"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->   
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <clip pos="2" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
      </action>
    </rule>


    <rule comment="pro HAVER + PP (l'han vist - have seen it)">
<!--comprobar a necesidade desta regra en galego-->
      <pattern>
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_pp"/>
		</lu> 
	      </chunk>
	      <b/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'lo ha habido' -->
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="3" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="lem"/> 
		  <lit v="be able to"/>
		</let>
		<let>
		  <clip pos="3" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
		      <equal>
			<clip pos="3" side="sl" part="pron"/>
			<lit-tag v="pron"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/> 
			<clip pos="3" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="1" side="tl" part="lem"/>
			<clip pos="1" side="tl" part="a_prn"/>
			<clip pos="1" side="tl" part="tipus_prn"/>
			<clip pos="1" side="tl" part="pers"/>
			<clip pos="1" side="tl" part="gen"/>
			<clip pos="1" side="tl" part="nbr"/>		           
			<clip pos="3" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_pp"/>
		      <clip pos="3" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<choose><!-- ... i després enviem el prn (si cal)-->
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="3" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="1" side="sl" part="pers"/>
			  <clip pos="2" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="1" side="sl" part="nbr"/>
			    <clip pos="2" side="sl" part="nbr"/>
			  </equal>
			  <equal>
			    <clip pos="1" side="sl" part="lem"/>
			    <lit v="se"/><!--é 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="2"/>
		    </call-macro>
		  </when>
		  <otherwise>
		    <out>
		      <b pos="2"/>
		      <chunk name="pro">
			<tags>
			  <tag><lit-tag v="SN"/></tag>
			  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="1" side="sl" part="pers"/></tag>
			  <tag><clip pos="1" side="tl" part="gen"/></tag>
			  <tag><clip pos="1" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="1" side="tl" part="whole"/>
			</lu>
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

	 

<rule comment="REGRA: PROCLÍTIC HAI">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="há"/>
      </pattern>
      <action> 	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
      <let>
	<clip pos="2" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	      <b/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
      </action>
</rule>



    <rule comment="REGRA: PROCLÍTIC VERB conxugado">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>	 
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal>
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--é 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="1"/>
		</call-macro>
	      </when>
	      <otherwise>
		<out>
		  <b pos="1"/>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="VERBO + ENCL (axudarme - help me)">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>

    <rule comment="VERBO + ENCL (axúdame - help me)">
      <pattern>
	<pattern-item n="verbnm_imp"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="se"/><!--é 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--elimina o pronome cando coincide en pers e nbr co verbo pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>


    <rule comment="VERB + ENCL + ENCL (traermos - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<choose>
	  <when>
	    <test><!--se o segundo enclítico non se traduce por nada (en/hi/[se]) -->
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="VERB + ENCL + ENCL (traédemos - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="se"/><!--é 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--elimina o pronome cando coincide en pers e nbr co verbo pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



 


    <rule comment="VERBMOD + ENCL + INF (poder-ho fer - be able to do it)(no he fet res per a pronominals, difícil fer la concordança de persona en frases que no són de 3a persona ('es'): per poder-te enamorar...">
      <pattern>
	<pattern-item n="verbm"/> <!-- aquí tb separaria entre inf/ger i imperatiu, per poder fer enllaços coherents en 'temps' i poder deixar temps 'sl' en imperatiu i 'tl' en inf i ger.-->
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>      
		    <clip pos="3" side="tl" part="a_verb"/>    
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>      
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>      
		  <clip pos="3" side="tl" part="a_verb"/>    
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>      
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="VERBMOD + ENCL + ENCL + INF (poder-los-ho explicar -> be able to explain it to them)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>    
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>    
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps"/>      
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>     
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps"/>    
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


    <rule comment="VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-ho xxx - be able to it xxx)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-los-ho xxx - be able to them it xxx" >
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>




    <rule comment="REGRA: PARTICIPI (perquè no enviï gènere ni nombre quan va sol (per tal que no doni error). Caldrà posar-lo tb en les regles d'adjectiu">
      <pattern>
	<pattern-item n="pp"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="PER + INF (per ajudar - to help (en general; cal estudiar quan hi va gerundi)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>      	
	<call-macro n="prep_inf">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk namefrom="tempsv">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>          
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>

  <rule comment="AL + INF (al llegar - when arriving)">
      <pattern>
	<pattern-item n="a"/>
	<pattern-item n="o"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="3" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="cnjadv"/></tag>
	    </tags>
	    <lu>
	      <lit v="when"/>
	      <lit-tag v="cnjadv"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="ger">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>          
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>  
      </action>
    </rule>


<!-- <rule comment="REGRA: PARTICIPI + per (canvia 'for' per 'by' ja que es considera que generalment serà passiva.">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="por"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/> 
	  <lit v="by"/>
	</let>	  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="pr">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out> 
      </action>
    </rule> -->




    <rule comment="PP + PER + INF (preparat per ajudar - prepared to help (perquè no entri per la regla anterior i digui 'prepared by')">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>      	
	<call-macro n="prep_inf"><!---MG: en aquest cas, el 'de' potser hauria de traduir-se per 'of'? -->
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp_pr_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  <b pos="2"/>
	    <lu>          
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="REGRA: VERB no conxugado (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<out>
	  <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGRA: VERB no conxugado (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>




  <rule comment="REGRA: ESTAR + GER (estan estudiant)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	    </lu>
	    <b pos="1"/>	    
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>






 <rule comment="REGRA: PROCLÍTIC ESTAR GER (els estan buscant) mireia falta els negatius">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (els estan traient -> are taking them out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="2" side="tl" part="a_verb"/></tag>
		<tag><var n="temps_chunk"/></tag>
		<tag><clip pos="2" side="tl" part="pers"/></tag>
		<tag><clip pos="2" side="tl" part="nbr"/></tag>
	      </tags>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <b pos="1"/>
		  <mlu>	    
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps"/>   
		    </lu>  
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>		           
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="1"/>	    
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal>
			<clip pos="1" side="sl" part="lem"/>
			<lit v="se"/><!--é 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
		</call-macro>
	      </when>
	      <otherwise>
		<out>
		  <b pos="2"/>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
 </rule>



    <!--**************************** SV precedits d'adverbi (negacions i altres) -->

 <rule comment="REGRA: ADV HAY (no había)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="há"/>
      </pattern>
      <action> 	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>	      
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <lit v="be"/>
	</let>
	<let>
	  <clip pos="2" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<call-macro n="conj_haverhi">
	      <with-param pos="2"/>
	</call-macro> 
	<out>
	      <chunk namefrom="lema_SV"  case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	    </out>
      </action>
 </rule>



    <rule comment="REGRA: ADV VERB conxugado (no volia)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>	      
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>	
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="ADV HAVER + PP (no han vist - have  seen)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<choose>
	  <when><!--Mira si és 'ha habido'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV"  case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->   
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>

	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <clip pos="3" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
	  </otherwise>
	</choose>
      </action>
    </rule>




    <rule comment="ADV pro HAVER + PP (no els han vist - have not seen them)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose> 
	<choose>
	  <when><!--Mira si és '(lo) ha habido' -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haber"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <lit v="there"/> 
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'ha habido' -->
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="lem"/> 
		  <lit v="be able to"/>
		</let>
		<let>
		  <clip pos="4" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>

	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="4" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
		      <equal>
			<clip pos="4" side="sl" part="pron"/>
			<lit-tag v="pron"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/> 
			<clip pos="4" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_pp"/>
		      <clip pos="4" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<!-- ... i després enviem el prn (si cal)-->
		<choose>
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="4" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="pers"/>
			  <clip pos="3" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="2" side="sl" part="nbr"/>
			    <clip pos="3" side="sl" part="nbr"/>
			  </equal>
			  <equal>
			    <clip pos="2" side="sl" part="lem"/>
			    <lit v="se"/><!--é 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="3"/>
		    </call-macro>
		  </when>
		  <otherwise>
		    <out>
		      <b pos="3"/>
		      <chunk name="pro">
			<tags>
			  <tag><lit-tag v="SN"/></tag>
			  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="2" side="sl" part="pers"/></tag>
			  <tag><clip pos="2" side="tl" part="gen"/></tag>
			  <tag><clip pos="2" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="2" side="tl" part="whole"/>
			</lu>
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

    <rule comment="PER + INF (per no oblidar - not to forget">
      <pattern>
	<pattern-item n="para"/> 
	<pattern-item n="non"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv.NEG"/></tag>
	    </tags>
	    <lu>
	      <lit v="not"/>
	      <clip pos="2" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="to">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <lit v="to"/>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="inf">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>               
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>



 <rule comment="REGRA: ADV PROCLÍTIC VERB conxugado (no el veig) MG: aquí no he posat lo de 'no lo hubo' perquè és molt més freqüent que la següent paraula sigui desconeguda. només es mira si és 'hay'">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="há_lex"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<let>
	  <clip pos="3" side="tl" part="lem"/>
	  <lit v="be"/>
	</let>
	<let>
	  <clip pos="3" side="tl" part="a_verb"/>
	  <lit-tag v="vbser"/>
	</let>
	<call-macro n="conj_haverhi">
	  <with-param pos="3"/>
	</call-macro> 
	<out>
	  <chunk namefrom="lema_SV"  case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><var n="pers_chunk"/></tag>
	      <tag><var n="nbr_chunk"/></tag>
	    </tags>
	    <lu>
	      <lit v="there"/> 
	      <lit-tag v="adv"/>
	    </lu>
	    <b/>
	    <lu>
	      <var n="verbfinal"/> 
	    </lu>		  
	  </chunk>
	  <b pos="2"/>
	  <chunk name="pro">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
 </rule>




    <rule comment="REGRA: ADV PROCLÍTIC VERB conxugado (no el veig)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  

<!--	<choose>
	  <when>
	    <test>
	     <and>
		<equal>
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit v="be"/>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="3"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu>		  
	      </chunk>
	      <b pos="2"/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu>
	      </chunk>
	    </out>
	  </when> -->
<choose>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise><!--Si no és separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics (si no és haver-hi) -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal>
			<clip pos="2" side="sl" part="lem"/>
			<lit v="se"/><!--é 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
		</call-macro>
	      </when>
	      <otherwise>	
		<out>
		  <b pos="2"/>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>	
	      </otherwise>
	    </choose> 
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL (no ajudar-me - not to help me) (posar-ho en gerundi en anglès?)">
      <pattern>
	<pattern-item n="non"/>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="to_verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags> 
		<lu>
		  <lit v="not"/>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="to"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="to_verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="sl" part="temps"/></tag>
		</tags> 
		<lu>
		  <lit v="not"/>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <lit v="to"/>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL + ENCL (no portar-me'ls - not to bring them to me)(en gerundi?)">
      <pattern>
	<pattern-item n="non"/> 
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="NO + VERBMOD + ENCL + INF (no poder-ho fer - not being able to do it)(aquí ho he posat en gerundi, en els altres casos d'infinitiu negat no, revisar)">
      <pattern>
	<pattern-item n="non"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <lit v="not"/>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>      
		    <clip pos="4" side="tl" part="a_verb"/>    
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>      
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <lit v="not"/>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>      
		  <clip pos="4" side="tl" part="a_verb"/>    
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps"/>      
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="NO + VERBMOD + ENCL + ENCL + INF (no poder-los-ho explicar -> not being able to explain it to them)">
      <pattern>
	<pattern-item n="non"/> 
	<pattern-item n="verbm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>   
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>     
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>      
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>    
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="not"/>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>    
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>    
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="to"/>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-ho xxx - not being able to it xxx)">
      <pattern>
	<pattern-item n="non"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="not"/>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>      
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-los-ho xxx - not being able to them it xxx)">
      <pattern>
	<pattern-item n="non"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <lit v="not"/>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>




    <rule comment="REGRA: NO + INF (no jugar - not playing)">
      <pattern>
	<pattern-item n="non"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/> 
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <lit v="not"/>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGRA: NO + GER (no fent - not doing)">
      <pattern>
	<pattern-item n="non"/> 
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <lit v="be able to"/>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="no_ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <lit v="not"/>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>


    <!--************************************ ALTRES ************************************************ -->

    <rule comment="ADV">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="non"/>
	      </equal>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="whole"/>
	    </let>
	    <append n="paraula1">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="1" side="tl" part="neg"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

<rule comment="ADV ITG">
      <pattern>
	<pattern-item n="advitg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>


<rule comment="PRONOM tònic/interrogatiu/possessiu"> 
      <pattern>
	<pattern-item n="tn_itg_pos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="PRN personal">
      <pattern>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prpers" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>  
	      <clip pos="1" side="tl" part="a_prn"/>  
	      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    
  <rule comment="PREP PRN personal (amb ell = with him (prn obj))">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="tipus_prn"/> 
	  <lit-tag v="obj"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="pl"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="mf"/><!--ells/elles = them (mf)-->
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="prpers">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/>  
	      <clip pos="2" side="tl" part="a_prn"/>  
	      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="2" side="tl" part="pers"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    

  <rule comment="PREP PRN personal (amb ell = with him (prn obj))">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="o_que"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="rel">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_rel"/></tag>
	    </tags>
	    <lu>
	      <lit v="which"/>
	      <lit-tag v="rel.an.mf.sp"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>
    

 <rule comment="CNJ">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="cnj" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="tags"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

 <rule comment="de">
      <pattern>
	<pattern-item n="de"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="de" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


  <rule comment="REL">
      <pattern>
	<pattern-item n="rel"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="rel" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_rel"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

    <rule> <!-- REGLA: reset variables-->
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
  <rule comment="REGRA: reset variables">
      <pattern>
	<pattern-item n="coma"/>
      </pattern>
      <action>
<!--	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let> -->
        <let>
	  <var n="EOS"/>
	  <lit v="false"/>
	</let>
	<out>
	  <chunk name="coma">
	    <tags>
	      <tag><lit-tag v="cm"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
  </rule>


  </section-rules>
</transfer>
